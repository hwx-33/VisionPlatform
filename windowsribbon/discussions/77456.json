[
  {
    "Id": "264860",
    "ThreadId": "77456",
    "Html": "<p>I'm trying to compile and run the samples but I get the following&nbsp;errors for the pre-build events. I am running Visual Studio 2008 SP1 on&nbsp;Windows 7 with Windows 7 SDK installed. Can you help me?</p>\r\n<p><span style=\"color:#000000\">\r\n<pre>cannot open input file '...\\RibbonTest\\RibbonMarkup.res'\r\nThe command &quot;.bml&quot; /res:&quot;...\\RibbonTest\\RibbonMarkup.rc&quot;\r\n&quot;%PROGRAMFILES%\\Microsoft SDKs\\Windows\\v7.0\\Bin\\rc.exe&quot; /v &quot;...\\RibbonTest\\RibbonMarkup.rc&quot;\r\ncmd /c &quot;(&quot;C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\..\\..\\VC\\bin\\vcvars32.bat&quot;) &amp;&amp; (&quot;C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\..\\..\\VC\\bin\\link.exe&quot; /VERBOSE /NOENTRY /DLL /OUT:&quot;...\\RibbonTest\\bin\\Release\\RibbonTest.ribbon.dll&quot; &quot;...\\RibbonTest\\RibbonMarkup.res&quot;)&quot;&quot; exited with code 1181.</pre>\r\n</span></p>",
    "PostedDate": "2009-12-08T03:15:44.08-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "265129",
    "ThreadId": "77456",
    "Html": "<p>Please send me the whole compilation output.</p>\r\n<p>Also,&nbsp;try to run the prebuild commands yourself from cmd. In this way some of the utilities provide more info on the problem.<br>[when doing so, note that you have to change the visual studio directory macros to the actual directories in your project]</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-12-08T15:51:54.61-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "265194",
    "ThreadId": "77456",
    "Html": "<p>Hi! Thanks for the quick&nbsp;responce.</p>\r\n<p>I have already tried to run the commands manually from cmd and they seem to&nbsp;work just fine. I saw the .bml and .rc files created as expected.</p>\r\n<p>What I sent before was the&nbsp;errors from the&nbsp;'Error List' window.&nbsp;This is from the 'Output' window:</p>\r\n<pre>------ Build started: Project: 02-ApplicationMenuButton, Configuration: Debug Any CPU ------\r\n&quot;%PROGRAMFILES%\\Microsoft SDKs\\Windows\\v7.0\\Bin\\UICC.exe&quot; &quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.xml&quot; &quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.bml&quot; /res:&quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.rc&quot;\r\n&quot;%PROGRAMFILES%\\Microsoft SDKs\\Windows\\v7.0\\Bin\\rc.exe&quot; /v &quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.rc&quot;\r\ncmd /c &quot;(&quot;c:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\..\\..\\VC\\bin\\vcvars32.bat&quot;) &amp;&amp; (&quot;c:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\..\\..\\VC\\bin\\link.exe&quot; /VERBOSE /NOENTRY /DLL /OUT:&quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\bin\\Debug\\02-ApplicationMenuButton.ribbon.dll&quot; &quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.res&quot;)&quot;\r\n\r\nThe system cannot find the path specified.\r\nThe system cannot find the path specified.\r\nSetting environment for using Microsoft Visual Studio 2008 x86 tools.\r\nMicrosoft (R) Incremental Linker Version 9.00.30729.01\r\nCopyright (C) Microsoft Corporation.  All rights reserved.\r\n\r\n\r\nStarting pass 1\r\nLINK : fatal error LNK1181: cannot open input file 'F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.res'\r\nC:\\Windows\\Microsoft.NET\\Framework\\v3.5\\Microsoft.Common.targets(895,9): error MSB3073: The command &quot;&quot;%PROGRAMFILES%\\Microsoft SDKs\\Windows\\v7.0\\Bin\\UICC.exe&quot; &quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.xml&quot; &quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.bml&quot; /res:&quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.rc&quot;\r\nC:\\Windows\\Microsoft.NET\\Framework\\v3.5\\Microsoft.Common.targets(895,9): error MSB3073: &quot;%PROGRAMFILES%\\Microsoft SDKs\\Windows\\v7.0\\Bin\\rc.exe&quot; /v &quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.rc&quot;\r\nC:\\Windows\\Microsoft.NET\\Framework\\v3.5\\Microsoft.Common.targets(895,9): error MSB3073: cmd /c &quot;(&quot;c:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\..\\..\\VC\\bin\\vcvars32.bat&quot;) &amp;&amp; (&quot;c:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\..\\..\\VC\\bin\\link.exe&quot; /VERBOSE /NOENTRY /DLL /OUT:&quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\bin\\Debug\\02-ApplicationMenuButton.ribbon.dll&quot; &quot;F:\\Windows Ribbon for WinForms\\Samples\\02-ApplicationMenuButton\\RibbonMarkup.res&quot;)&quot;\r\nC:\\Windows\\Microsoft.NET\\Framework\\v3.5\\Microsoft.Common.targets(895,9): error MSB3073: &quot; exited with code 1181.\r\nDone building project &quot;02-ApplicationMenuButton.csproj&quot; -- FAILED.\r\n========== Build: 0 succeeded, 1 failed, 1 up-to-date, 0 skipped ==========\r\n</pre>\r\n<p>Thanks!</p>",
    "PostedDate": "2009-12-08T23:04:52.18-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "265340",
    "ThreadId": "77456",
    "Html": "<p>Hello again and sorry for the double post!</p>\r\n<p>I have recreated the first sample from scratch in VB, which is my preferred language. Again, I get the same errors for the pre-build events.<br>When I execute the commands myself from a batch file, everything works perfectly.<br>Note that I have substituted all visual studio directory macros with the paths I get from the visual studio output window.<br>This is the batch file:</p>\r\n<pre>echo off\r\ncls\r\n&quot;%PROGRAMFILES%\\Microsoft SDKs\\Windows\\v7.0\\Bin\\UICC.exe&quot; &quot;F:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.xml&quot; &quot;F:\\Visual Studio\r\nProjects\\RibbonTest\\RibbonTest\\RibbonMarkup.bml&quot; /res:&quot;F:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.rc&quot;\r\n&quot;%PROGRAMFILES%\\Microsoft SDKs\\Windows\\v7.0\\Bin\\rc.exe&quot; /v &quot;F:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.rc&quot;\r\ncmd /c &quot;(&quot;c:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\..\\..\\VC\\bin\\vcvars32.bat&quot;) &amp;&amp; (&quot;c:\\Program Files (x86)\\Microsoft Visual\r\nStudio 9.0\\Common7\\IDE\\..\\..\\VC\\bin\\link.exe&quot; /NOENTRY /DLL /OUT:&quot;F:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\bin\\Debug\\RibbonTest.Ribbon.dll&quot; &quot;F:\r\n\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.res&quot;)&quot;\r\npause</pre>\r\n<p>This is what I get after executing the batch file:</p>\r\n<pre>F:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.xml(9): warning SC2\r\n002 : Undefined property: 'ApplicationMenu'. Using default value.\r\nF:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.xml(9): warning SC2\r\n002 : Undefined property: 'Tab'. Using default value.\r\nF:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.xml(9): warning SC2\r\n002 : Undefined property: 'QuickAccessToolbar'. Using default value.\r\nF:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.xml : warning SC200\r\n1 at /Application/Application.Views/Ribbon/Ribbon.ApplicationMenu/ApplicationMen\r\nu: Undefined Command on element.\r\nF:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.xml : warning SC200\r\n1 at /Application/Application.Views/Ribbon/Ribbon.Tabs/Tab: Undefined Command on\r\n element.\r\nHeader file generation successful: '(null)'.\r\nRibbon markup file validation successful: 'F:\\Visual Studio Projects\\RibbonTest\\\r\nRibbonTest\\RibbonMarkup.xml'.\r\nRibbon resource file generation successful: 'F:\\Visual Studio Projects\\RibbonTes\r\nt\\RibbonTest\\RibbonMarkup.rc'.\r\nMicrosoft (R) Windows (R) Resource Compiler Version 6.1.7600.16385\r\nCopyright (C) Microsoft Corporation.  All rights reserved.\r\nUsing codepage 1253 as default\r\nCreating F:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.res\r\nF:\\Visual Studio Projects\\RibbonTest\\RibbonTest\\RibbonMarkup.rc...\r\nWriting UIFILE:APPLICATION_RIBBON,      lang:0x409,     size 1042\r\nWriting STRING:3751,    lang:0x409,     size 104\r\nSetting environment for using Microsoft Visual Studio 2008 x86 tools.\r\nMicrosoft (R) Incremental Linker Version 9.00.30729.01\r\nCopyright (C) Microsoft Corporation.  All rights reserved.\r\nLINK : warning LNK4068: /MACHINE not specified; defaulting to X86\r\nPress any key to continue . . .</pre>\r\n<p>After that everything works as expected. I do not know what seems to be the problem.</p>\r\n<p>If it is of any help, I'm running the 64-bit edition of Windows 7.</p>\r\n<p>Thanks!</p>",
    "PostedDate": "2009-12-09T07:28:32.457-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "268950",
    "ThreadId": "77456",
    "Html": "<p>It seems that the environment variable <strong>%ProgramFiles%</strong> on your 64bit system is the cause for your problem.</p>\r\n<p>64 bit systems has two addional environment variables:<br><strong>%ProgramFiles(x86)%</strong> which defaults to &quot;C:\\Program Files (x86)&quot; and<br><strong>%ProgramW6432%</strong> which defaults to C:\\Program Files</p>\r\n<p>The value of <strong>%ProgramFiles%</strong> on 64bit systems depends on whether the calling process is itself a 32bit process or 64bit process.</p>\r\n<p>Try to replace <strong>%ProgramFiles%</strong> with both <strong>%ProgramFiles(x86)%</strong> and <strong>%ProgramW6432%</strong> and let us know which one works on your system.<br>Unfortunately, I don't have a 64bit machine to test it myself.</p>",
    "PostedDate": "2009-12-18T08:14:13.803-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "280268",
    "ThreadId": "77456",
    "Html": "<p>You were right; %ProgramFiles% was causing the problem.</p>\r\n<p>Visual Studio 2008 is a 32-bit process, so %ProgramFiles% expands to &quot;C:\\Program Files (x86)&quot;.<br>On the other hand, Windows 7 SDK is 64-bit and is installed in &quot;C:\\Program Files\\Microsoft SDKs\\Windows\\v7.0&quot;.</p>\r\n<p>The correct pre-build event for 64-bit Windows is:</p>\r\n<pre>&quot;<strong>%ProgramW6432%</strong>\\Microsoft SDKs\\Windows\\v7.0\\Bin\\UICC.exe&quot;  &quot;$(ProjectDir)RibbonMarkup.xml&quot; &quot;$(ProjectDir)RibbonMarkup.bml&quot; /res:&quot;$(ProjectDir)RibbonMarkup.rc&quot;\r\n&quot;<strong>%ProgramW6432%</strong>\\Microsoft SDKs\\Windows\\v7.0\\Bin\\rc.exe&quot; /v &quot;$(ProjectDir)RibbonMarkup.rc&quot;\r\ncmd /c &quot;(&quot;$(DevEnvDir)..\\..\\VC\\bin\\vcvars32.bat&quot;) &amp;&amp; (&quot;$(DevEnvDir)..\\..\\VC\\bin\\link.exe&quot; /VERBOSE /NOENTRY /DLL /OUT:&quot;$(ProjectDir)$(OutDir)$(TargetName).ribbon.dll&quot; &quot;$(ProjectDir)RibbonMarkup.res&quot;)&quot;</pre>\r\n<p>Thanks!</p>",
    "PostedDate": "2010-01-21T14:03:15.557-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]